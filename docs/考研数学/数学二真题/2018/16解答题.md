## 🎯 问题回顾

已知连续函数 $f(x)$ 满足积分方程：
$$
\int_{0}^{x}f(t)dt + \int_{0}^{x}t f(x-t)dt = ax^{2}
$$

我们需要完成以下两个任务：
(I) 求函数 $f(x)$ 的解析式；
(II) 若 $f(x)$ 在区间 $[0,1]$ 上的平均值为 1，求常数 $a$ 的值。

---

## 第一部分：求 $f(x)$ 的解析式

### 1.1 处理卷积型积分
观察方程中的第二项 $\int_{0}^{x}t f(x-t)dt$，这是一个典型的卷积形式。为了方便求导，我们需要通过变量代换将其变形，把积分上限 $x$ 从 $f$ 的自变量中移出来。

**令 $u = x - t$**，则：
- $t = x - u$
- $dt = -du$
- 当 $t = 0$ 时，$u = x$；当 $t = x$ 时，$u = 0$。

代入积分项：
$$
\begin{aligned}
\int_{0}^{x} t f(x-t) dt &= \int_{x}^{0} (x-u) f(u) (-du) \\
&= \int_{0}^{x} (x-u) f(u) du \\
&= \int_{0}^{x} x f(u) du - \int_{0}^{x} u f(u) du \\
&= x\int_{0}^{x} f(u) du - \int_{0}^{x} u f(u) du
\end{aligned}
$$
为了符号统一，我们将积分变量 $u$ 换回 $t$（积分变量符号不影响定积分的值）：
$$
\int_{0}^{x} t f(x-t) dt = x\int_{0}^{x} f(t) dt - \int_{0}^{x} t f(t) dt
$$

### 1.2 重写原方程
将变形后的积分项代回原方程：
$$
\int_{0}^{x}f(t)dt + \left[ x\int_{0}^{x} f(t) dt - \int_{0}^{x} t f(t) dt \right] = ax^{2}
$$

合并同类项（含有 $\int_{0}^{x}f(t)dt$ 的项）：
$$
(1+x)\int_{0}^{x} f(t) dt - \int_{0}^{x} t f(t) dt = ax^{2}
$$

### 1.3 两边对 $x$ 求导（第一次）
利用变上限积分求导公式 $\frac{d}{dx}\int_{0}^{x} g(t)dt = g(x)$，对上式两边关于 $x$ 求导。

**左边求导：**
- 第一部分 $(1+x)\int_{0}^{x} f(t) dt$ 使用乘法求导法则：
  $$
  [(1+x)]' \cdot \int_{0}^{x} f(t) dt + (1+x) \cdot \left[ \int_{0}^{x} f(t) dt \right]'
  = 1 \cdot \int_{0}^{x} f(t) dt + (1+x)f(x)
  $$
- 第二部分 $-\int_{0}^{x} t f(t) dt$ 直接求导：
  $$
  -x f(x)
  $$

**右边求导：**
$$
(ax^2)' = 2ax
$$

**整理求导后的等式：**
$$
\int_{0}^{x} f(t) dt + (1+x)f(x) - x f(x) = 2ax
$$
化简得：
$$
\int_{0}^{x} f(t) dt + f(x) = 2ax \quad \cdots\cdots \text{(*)}
$$

### 1.4 确定初值条件
在进行下一步求导前，我们需要从式 $(*)$ 中提取初始条件 $f(0)$。
令 $x = 0$ 代入式 $(*)$：
$$
\int_{0}^{0} f(t) dt + f(0) = 2a(0)
$$
由于积分上下限相同，积分值为 0，故：
$$
0 + f(0) = 0 \implies f(0) = 0
$$

### 1.5 两边对 $x$ 求导（第二次）
对式 $(*)$ 再次求导：
$$
\left[ \int_{0}^{x} f(t) dt \right]' + f'(x) = (2ax)'
$$
得到一阶线性微分方程：
$$
f(x) + f'(x) = 2a
$$
即：
$$
y' + y = 2a
$$

### 1.6 求解微分方程
这是一个一阶线性非齐次微分方程。

1.  **求齐次方程 $y' + y = 0$ 的通解：**
    特征方程 $r + 1 = 0 \implies r = -1$。
    故齐次通解为 $y_h = Ce^{-x}$。

2.  **求特解 $y_p$：**
    由于方程右端 $2a$ 是常数，设特解为常数 $y_p = K$。
    代入方程：$0 + K = 2a \implies K = 2a$。
    故特解为 $y_p = 2a$。

3.  **得到通解：**
    $$
    f(x) = Ce^{-x} + 2a
    $$

4.  **利用初值确定常数 $C$：**
    由 1.4 节得 $f(0) = 0$。代入通解：
    $$
    0 = Ce^{0} + 2a \implies C = -2a
    $$

### 1.7 结论 (I)
将 $C = -2a$ 代回通解，得到 $f(x)$ 的解析式：
$$
f(x) = 2a - 2ae^{-x} = 2a(1 - e^{-x})
$$

---

## 第二部分：求常数 $a$ 的值

### 2.1 平均值的定义
函数 $f(x)$ 在区间 $[0, 1]$ 上的平均值 $\bar{f}$ 定义为：
$$
\bar{f} = \frac{1}{1-0} \int_{0}^{1} f(x) dx = \int_{0}^{1} f(x) dx
$$
题目已知平均值为 1，故：
$$
\int_{0}^{1} f(x) dx = 1
$$

### 2.2 计算定积分
将 (I) 中求得的 $f(x) = 2a(1 - e^{-x})$ 代入积分式：

$$
\begin{aligned}
\int_{0}^{1} 2a(1 - e^{-x}) dx &= 2a \int_{0}^{1} (1 - e^{-x}) dx \\
&= 2a \left[ x - (-e^{-x}) \right]_{0}^{1} \\
&= 2a \left[ x + e^{-x} \right]_{0}^{1}
\end{aligned}
$$

### 2.3 代入上下限计算
$$
\begin{aligned}
\left[ x + e^{-x} \right]_{0}^{1} &= (1 + e^{-1}) - (0 + e^{0}) \\
&= 1 + \frac{1}{e} - 1 \\
&= \frac{1}{e}
\end{aligned}
$$
所以积分值为：
$$
2a \cdot \frac{1}{e} = \frac{2a}{e}
$$

### 2.4 求解 $a$
根据题意：
$$
\frac{2a}{e} = 1
$$
解得：
$$
a = \frac{e}{2}
$$

---

## ✅ 最终答案

(I) 函数 $f(x)$ 的解析式为：
$$
f(x) = 2a(1 - e^{-x})
$$

(II) 常数 $a$ 的值为：
$$
a = \frac{e}{2}
$$

---

## 📌 关键步骤总结

1.  **换元处理卷积**：看到 $\int_{0}^{x} t f(x-t) dt$ 形式，第一时间想到令 $u=x-t$，将其拆分为 $x\int f - \int tf$，这是解决此类积分方程的标准起手式。
2.  **求导降阶**：通过对积分方程两边求导，消去积分符号，将积分方程转化为微分方程。本题求导了两次。
3.  **挖掘隐性条件**：在求导过程中产生的中间方程（如 $\int_{0}^{x} f(t) dt + f(x) = 2ax$），令 $x=0$ 往往能得到微分方程的初始条件（如 $f(0)=0$）。
4.  **平均值公式**：牢记函数平均值公式 $\frac{1}{b-a}\int_a^b f(x)dx$。