## 🎯 问题回顾

已知分段函数：

$$
f(x) = \begin{cases} 2(x-1), & x < 1 \\ \ln x, & x \ge 1 \end{cases}
$$

求 $f(x)$ 的一个原函数 $F(x)$。

选项：
- (A) $F(x)=\begin{cases}(x-1)^{2},&x<1,\\ x(\ln x-1),&x\ge1.\end{cases}$
- (B) $F(x)=\begin{cases}(x-1)^{2},&x<1,\\ x(\ln x+1)-1,&x\ge1.\end{cases}$
- (C) $F(x)=\begin{cases}(x-1)^{2},&x<1,\\ x(\ln x+1)+1,&x\ge1.\end{cases}$
- (D) $F(x)=\begin{cases}(x-1)^{2},&x<1,\\ x(\ln x-1)+1,&x\ge1.\end{cases}$

---

## 第一部分：分段求不定积分

原函数 $F(x)$ 满足 $F'(x) = f(x)$。我们分别对两段区间进行积分。

### 1.1 当 $x < 1$ 时

$$
F(x) = \int 2(x-1) dx = (x-1)^2 + C_1
$$
观察所有选项，均取 $C_1 = 0$，即此段为 $F(x) = (x-1)^2$。

### 1.2 当 $x \ge 1$ 时

$$
F(x) = \int \ln x dx
$$
使用分部积分法：令 $u = \ln x, dv = dx$，则 $du = \frac{1}{x}dx, v = x$。
$$
\int \ln x dx = x\ln x - \int x \cdot \frac{1}{x} dx = x\ln x - x + C_2 = x(\ln x - 1) + C_2
$$

> 💡 **快速排除法**：
> 对选项 (B) 和 (C) 中的 $x \ge 1$ 部分求导：
> $[x(\ln x + 1)]' = \ln x + 1 + x(\frac{1}{x}) = \ln x + 2 \ne \ln x$。
> 因此 **(B) 和 (C) 错误**，答案必在 (A) 或 (D) 中。

---

## 第二部分：利用连续性确定常数

### 2.1 原函数的连续性性质

原函数 $F(x)$ 必须在整个定义域内**连续**（原函数是可导函数，可导必连续）。
因此，在分段点 $x=1$ 处，必须满足：
$$
\lim_{x \to 1^-} F(x) = F(1)
$$

### 2.2 计算左右极限

1.  **左极限**（由 $x < 1$ 部分）：
    $$
    \lim_{x \to 1^-} F(x) = \lim_{x \to 1^-} (x-1)^2 = (1-1)^2 = 0
    $$

2.  **函数值/右极限**（由 $x \ge 1$ 部分）：
    $$
    F(1) = 1 \cdot (\ln 1 - 1) + C_2 = -1 + C_2
    $$

### 2.3 建立方程求解 $C_2$

令左极限等于右极限：
$$
0 = -1 + C_2 \implies C_2 = 1
$$

因此，当 $x \ge 1$ 时，原函数表达式应为：
$$
F(x) = x(\ln x - 1) + 1
$$

---

## 第三部分：选项比对与结论

对比剩余选项 (A) 和 (D)：

- **(A)** $x \ge 1$ 时为 $x(\ln x - 1)$，对应常数 $C_2=0$。此时 $F(1)=-1 \ne F(1^-)$，不连续，**排除**。
- **(D)** $x \ge 1$ 时为 $x(\ln x - 1) + 1$，对应常数 $C_2=1$。此时 $F(1)=0 = F(1^-)$，连续，**正确**。

---

## ✅ 最终答案：**(D)**

---

## 📌 关键要点总结

1.  **原函数必连续**：这是解决分段函数原函数问题的核心。即使被积函数 $f(x)$ 有间断点，其原函数 $F(x)$ 也必须是连续的。
2.  **分段积分**：分别对每一段求不定积分，会产生不同的积分常数（如 $C_1, C_2$）。
3.  **定常数**：利用分段点处的连续性条件（左极限=右极限），建立常数之间的关系，从而确定具体的表达式。