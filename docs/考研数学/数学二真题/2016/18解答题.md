## 🎯 问题回顾

**解答题**：
设 $D$ 是由直线 $y=1, y=x, y=-x$ 围成的有界区域，计算二重积分：
$$
I = \iint_{D}\frac{x^{2}-xy-y^{2}}{x^{2}+y^{2}}dxdy
$$

---

## 第一部分：区域分析与对称性利用

### 1.1 积分区域 $D$ 的形状

积分区域 $D$ 由三条直线围成：
1.  上边界：$y=1$
2.  右边界：$y=x$
3.  左边界：$y=-x$

这是一个以原点 $(0,0)$ 为顶点，底边在 $y=1$ 上的等腰三角形。
顶点坐标为：$O(0,0), A(1,1), B(-1,1)$。
显然，区域 $D$ **关于 $y$ 轴对称**。

### 1.2 利用对称性简化被积函数

被积函数为 $f(x,y) = \dfrac{x^{2}-xy-y^{2}}{x^{2}+y^{2}}$。我们可以将其拆分为两部分：
$$
f(x,y) = \underbrace{\frac{x^{2}-y^{2}}{x^{2}+y^{2}}}_{f_1(x,y)} - \underbrace{\frac{xy}{x^{2}+y^{2}}}_{f_2(x,y)}
$$

1.  **关于 $f_2(x,y)$**：
    由于 $x$ 出现在分子的一次项中，$f_2(-x, y) = \frac{(-x)y}{(-x)^2+y^2} = -\frac{xy}{x^2+y^2} = -f_2(x,y)$。
    即 $f_2$ 关于 $x$ 是**奇函数**。
    因为积分区域 $D$ 关于 $y$ 轴（即 $x$ 的对称轴）对称，所以该项积分为 **0**。
    $$
    \iint_{D} - \frac{xy}{x^{2}+y^{2}} dxdy = 0
    $$

2.  **关于 $f_1(x,y)$**：
    $f_1(-x, y) = \frac{(-x)^2-y^2}{(-x)^2+y^2} = \frac{x^2-y^2}{x^2+y^2} = f_1(x,y)$。
    即 $f_1$ 关于 $x$ 是**偶函数**。
    我们可以只计算右半区域 $D_1$（即 $x \ge 0$ 的部分），然后乘以 2。

**简化后的积分**：
$$
I = 2 \iint_{D_1} \frac{x^{2}-y^{2}}{x^{2}+y^{2}} dxdy
$$
其中 $D_1$ 由 $y=x, y=1, x=0$ 围成。

---

## 第二部分：选择积分次序并计算

### 2.1 确定积分限（直角坐标系 X-型）

对于右半区域 $D_1$：
-   $y$ 的变化范围是 $0$ 到 $1$。
-   对于给定的 $y$， $x$ 的变化范围是 $0$ 到 $y$（从 $y$ 轴出发到直线 $y=x$）。

于是积分改写为二次积分：
$$
I = 2 \int_{0}^{1} dy \int_{0}^{y} \frac{x^{2}-y^{2}}{x^{2}+y^{2}} dx
$$

### 2.2 计算内层积分（关于 $x$）

$$
\int_{0}^{y} \frac{x^{2}-y^{2}}{x^{2}+y^{2}} dx
$$

使用代数变形技巧（分子凑分母）：
$$
\frac{x^{2}-y^{2}}{x^{2}+y^{2}} = \frac{(x^{2}+y^{2}) - 2y^{2}}{x^{2}+y^{2}} = 1 - \frac{2y^{2}}{x^{2}+y^{2}}
$$

代入积分：
$$
\begin{aligned}
\int_{0}^{y} \left( 1 - \frac{2y^{2}}{x^{2}+y^{2}} \right) dx &= \left[ x - 2y^2 \cdot \frac{1}{y}\arctan\left(\frac{x}{y}\right) \right]_{x=0}^{x=y} \\
&= \left[ x - 2y \arctan\left(\frac{x}{y}\right) \right]_{0}^{y}
\end{aligned}
$$

代入上下限：
-   当 $x=y$ 时：$y - 2y \arctan(1) = y - 2y \cdot \frac{\pi}{4} = y\left(1 - \frac{\pi}{2}\right)$
-   当 $x=0$ 时：$0 - 0 = 0$

故内层积分结果为：
$$
y\left(1 - \frac{\pi}{2}\right)
$$

### 2.3 计算外层积分（关于 $y$）

将内层结果代回 $I$ 的表达式：
$$
\begin{aligned}
I &= 2 \int_{0}^{1} y\left(1 - \frac{\pi}{2}\right) dy \\
&= 2 \left(1 - \frac{\pi}{2}\right) \int_{0}^{1} y \, dy \\
&= 2 \left(1 - \frac{\pi}{2}\right) \cdot \left[ \frac{y^2}{2} \right]_{0}^{1} \\
&= 2 \left(1 - \frac{\pi}{2}\right) \cdot \frac{1}{2} \\
&= 1 - \frac{\pi}{2}
\end{aligned}
$$

---

## ✅ 最终答案

$$
1 - \frac{\pi}{2}
$$

---

## 📌 关键要点总结

1.  **奇偶对称性（核心技巧）**：在计算二重积分前，务必先观察区域的对称性和被积函数的奇偶性。本题中利用 $x$ 的奇函数性质直接消去了 $-xy$ 项，并利用偶函数性质将区域缩小为一半，极大简化了运算。
2.  **分式裂项法**：处理 $\frac{x^2-y^2}{x^2+y^2}$ 类型的有理分式积分时，通过 $+y^2-y^2$ 或者拆分为 $1 - \frac{2y^2}{x^2+y^2}$ 是标准手段。
3.  **积分次序选择**：本题采用**先 $x$ 后 $y$**（X-型）的次序非常顺畅。若采用极坐标计算亦可（需将直线方程转化为极坐标形式），但对于本题的被积函数结构，直角坐标下的代数变形更为直接。