## 🎯 问题回顾

已知常数 $a$，矩阵 $A=\begin{pmatrix}1&2&a\\ 1&3&0\\ 2&7&-a\end{pmatrix}$ 经初等列变换化为矩阵 $B=\begin{pmatrix}1&a&2\\ 0&1&1\\ -1&1&1\end{pmatrix}$.

需要完成：
(I) 求 $a$ 的值；
(II) 求满足 $AP=B$ 的可逆矩阵 $P$.

---

## 第一部分：求 $a$ 的值

### 1.1 分析矩阵关系
矩阵 $A$ 经初等列变换化为 $B$，意味着矩阵 $A$ 与 $B$ 列等价。
根据线性代数性质，**若两个矩阵等价（或列等价），则它们的秩相等**。即：
$$
\text{rank}(A) = \text{rank}(B)
$$
这也意味着如果 $A$ 不可逆（行列式为 0），那么 $B$ 也不可逆。

### 1.2 计算行列式
首先计算矩阵 $A$ 的行列式 $|A|$：
$$
\begin{aligned}
|A| &= \begin{vmatrix}1&2&a\\ 1&3&0\\ 2&7&-a\end{vmatrix} \\
&= 1 \cdot (3 \cdot (-a) - 0) - 2 \cdot (1 \cdot (-a) - 0) + a \cdot (1 \cdot 7 - 2 \cdot 3) \\
&= -3a + 2a + a \\
&= 0
\end{aligned}
$$
由于 $|A| = 0$，说明 $\text{rank}(A) < 3$。

因此，矩阵 $B$ 的秩也必须小于 3，即 $|B| = 0$。计算 $|B|$：
$$
\begin{aligned}
|B| &= \begin{vmatrix}1&a&2\\ 0&1&1\\ -1&1&1\end{vmatrix} \\
&= 1 \cdot (1 \cdot 1 - 1 \cdot 1) - a \cdot (0 \cdot 1 - 1 \cdot (-1)) + 2 \cdot (0 \cdot 1 - 1 \cdot (-1)) \\
&= 0 - a(1) + 2(1) \\
&= 2 - a
\end{aligned}
$$
令 $|B| = 0$，解得：
$$
2 - a = 0 \implies a = 2
$$

### 1.3 验证秩相等
当 $a=2$ 时：
$$
A = \begin{pmatrix}1&2&2\\ 1&3&0\\ 2&7&-2\end{pmatrix}, \quad B = \begin{pmatrix}1&2&2\\ 0&1&1\\ -1&1&1\end{pmatrix}
$$
对 $A$ 进行初等行变换求秩：
$$
\begin{pmatrix}1&2&2\\ 1&3&0\\ 2&7&-2\end{pmatrix} \xrightarrow{r_2-r_1, r_3-2r_1} \begin{pmatrix}1&2&2\\ 0&1&-2\\ 0&3&-6\end{pmatrix} \xrightarrow{r_3-3r_2} \begin{pmatrix}1&2&2\\ 0&1&-2\\ 0&0&0\end{pmatrix}
$$
显然 $\text{rank}(A) = 2$。

对 $B$ 进行观察，第 2 列和第 3 列相同，且第 1、2 列线性无关，故 $\text{rank}(B) = 2$。
秩相等，故 $a=2$ 正确。

---

## 第二部分：求可逆矩阵 $P$

### 2.1 建立方程组
由题意 $A$ 经初等列变换化为 $B$，这等价于存在可逆矩阵 $P$，使得 $AP=B$。
设 $P = (\mathbf{p}_1, \mathbf{p}_2, \mathbf{p}_3)$，其中 $\mathbf{p}_i$ 为列向量。
设 $B = (\mathbf{b}_1, \mathbf{b}_2, \mathbf{b}_3)$。
则 $AP=B$ 可以拆解为三个线性方程组：
$$
A\mathbf{p}_1 = \mathbf{b}_1, \quad A\mathbf{p}_2 = \mathbf{b}_2, \quad A\mathbf{p}_3 = \mathbf{b}_3
$$
其中 $\mathbf{b}_1 = \begin{pmatrix}1\\0\\-1\end{pmatrix}, \mathbf{b}_2 = \begin{pmatrix}2\\1\\1\end{pmatrix}, \mathbf{b}_3 = \begin{pmatrix}2\\1\\1\end{pmatrix}$。

### 2.2 求解齐次方程组 $A\mathbf{x}=\mathbf{0}$
我们先求出 $A\mathbf{x}=\mathbf{0}$ 的通解（基础解系），这对构造可逆的 $P$ 至关重要。
对 $A$ 进行行变换（利用 1.3 中的结果）：
$$
A \to \begin{pmatrix}1&2&2\\ 0&1&-2\\ 0&0&0\end{pmatrix} \xrightarrow{r_1-2r_2} \begin{pmatrix}1&0&6\\ 0&1&-2\\ 0&0&0\end{pmatrix}
$$
同解方程组为 $\begin{cases} x_1 + 6x_3 = 0 \\ x_2 - 2x_3 = 0 \end{cases}$。
令自由变量 $x_3 = k$，得通解为 $\mathbf{x} = k \begin{pmatrix} -6 \\ 2 \\ 1 \end{pmatrix}$。
记基础解系为 $\boldsymbol{\eta} = (-6, 2, 1)^T$。

### 2.3 求解非齐次方程组
利用增广矩阵同时求解 $A\mathbf{p}_1 = \mathbf{b}_1$ 和 $A\mathbf{p}_2 = \mathbf{b}_2$（注意 $\mathbf{b}_3=\mathbf{b}_2$）。

$$
(A \mid \mathbf{b}_1, \mathbf{b}_2) = \begin{pmatrix}1&2&2 & 1&2\\ 1&3&0 & 0&1\\ 2&7&-2 & -1&1\end{pmatrix}
$$
行变换如下：
1. $r_2-r_1, r_3-2r_1$:
   $$
   \begin{pmatrix}1&2&2 & 1&2\\ 0&1&-2 & -1&-1\\ 0&3&-6 & -3&-3\end{pmatrix}
   $$
2. $r_1-2r_2, r_3-3r_2$:
   $$
   \begin{pmatrix}1&0&6 & 3&4\\ 0&1&-2 & -1&-1\\ 0&0&0 & 0&0\end{pmatrix}
   $$

**对于 $\mathbf{p}_1$ ($A\mathbf{x}=\mathbf{b}_1$)：**
特解为 $\begin{pmatrix}3\\-1\\0\end{pmatrix}$（取 $x_3=0$）。通解为 $\mathbf{p}_1 = \begin{pmatrix}3\\-1\\0\end{pmatrix} + k_1 \boldsymbol{\eta}$。
为了简单，取 $k_1=0$，得 $\mathbf{p}_1 = \begin{pmatrix}3\\-1\\0\end{pmatrix}$。

**对于 $\mathbf{p}_2$ ($A\mathbf{x}=\mathbf{b}_2$)：**
特解为 $\begin{pmatrix}4\\-1\\0\end{pmatrix}$（取 $x_3=0$）。通解为 $\mathbf{p}_2 = \begin{pmatrix}4\\-1\\0\end{pmatrix} + k_2 \boldsymbol{\eta}$。
为了简单，取 $k_2=0$，得 $\mathbf{p}_2 = \begin{pmatrix}4\\-1\\0\end{pmatrix}$。

**对于 $\mathbf{p}_3$ ($A\mathbf{x}=\mathbf{b}_3$)：**
因为 $\mathbf{b}_3 = \mathbf{b}_2$，所以通解形式与 $\mathbf{p}_2$ 相同：$\mathbf{p}_3 = \begin{pmatrix}4\\-1\\0\end{pmatrix} + k_3 \boldsymbol{\eta}$。
**关键点**：题目要求 $P$ 可逆，因此 $\mathbf{p}_1, \mathbf{p}_2, \mathbf{p}_3$ 必须线性无关。
若取 $k_3=0$，则 $\mathbf{p}_3 = \mathbf{p}_2$，矩阵 $P$ 不可逆。
因此，我们必须取 $k_3 \ne 0$。令 $k_3 = 1$，则：
$$
\mathbf{p}_3 = \begin{pmatrix}4\\-1\\0\end{pmatrix} + \begin{pmatrix}-6\\2\\1\end{pmatrix} = \begin{pmatrix}-2\\1\\1\end{pmatrix}
$$

### 2.4 构造并验证 $P$
构造矩阵 $P = (\mathbf{p}_1, \mathbf{p}_2, \mathbf{p}_3)$：
$$
P = \begin{pmatrix} 3 & 4 & -2 \\ -1 & -1 & 1 \\ 0 & 0 & 1 \end{pmatrix}
$$
验证 $P$ 是否可逆：
$$
|P| = \begin{vmatrix} 3 & 4 & -2 \\ -1 & -1 & 1 \\ 0 & 0 & 1 \end{vmatrix} = 1 \cdot (3(-1) - 4(-1)) = -3 + 4 = 1 \ne 0
$$
故 $P$ 可逆，且满足 $AP=B$。

---

## ✅ 最终答案

(I) $a$ 的值为 **2**.

(II) 满足条件的一个可逆矩阵 $P$ 为：
$$
P = \begin{pmatrix} 3 & 4 & -2 \\ -1 & -1 & 1 \\ 0 & 0 & 1 \end{pmatrix}
$$
*(注：答案不唯一，第三列可以是 $\begin{pmatrix}4\\-1\\0\end{pmatrix} + k\begin{pmatrix}-6\\2\\1\end{pmatrix}$ 中 $k\ne0$ 的任意向量)*